# 인터럽트(Interrupt)
* 프로그램을 실행하는 도중에 예기치 않은 상황이 발생할 경우 현재 실행중인 작업을 즉시 중단하고, 발생된 상황에 대한 우선 처리가 필요함을 CPU에게 알리는 것
* 하드웨어 장치가 CPU에게 어떤 사실을 알려주거나 CPU의 서비스를 요청해야 할 경우, CPU 내에 있는 인터럽트 라인을 세팅하여 인터럽트를 발생시킨다.(프로그램이 명령을 수행하기 위해서는 CPU를 할당받아야 함)
* CPU는 매번 프로그램 카운터가 가리키고 있는 곳의 명령을 수행한 뒤, 다음 명령을 수행하기 직전에 인터럽트 라인이 세팅되었는지 체크한다.
* 이를 통해 인터럽트가 발생했으면 CPU는 현재 수행 중이던 프로세스를 멈추고 운영 체제의 인터럽트 처리 루틴으로 이동하여 인터럽트 처리를 수행한다.

<br/>

## 인터럽트 종류
* 하드웨어 인터럽트(일반적인 인터럽트)
  * 하드웨어 컨트롤러가 CPU의 서비스를 요청하기 위해 발생시키는 인터럽트
  * 입출력 장치, 전원 등 외부적인 요인으로 발생(Ex. 전원 이상, 기계 착오 등)

#### 하드웨어 인터럽트 발생 과정
![하드웨어 인터럽트 발생 과정](https://camo.githubusercontent.com/0bdc55299ecd6497a0af69b4aaf23d55f7cbfe460606d2859ba0182ae7e688ad/68747470733a2f2f6b2e6b616b616f63646e2e6e65742f646e2f62776f7654512f62747176427032344753312f41787554416b45615a6151776f626f6471654566516b2f696d672e706e67)


* 소프트웨어 인터럽트(Trap:트랩)

1. 예외 상황(Exception)
* 프로그램이 허용되지 않은 연산을 수행하려고 할 때, 자동적으로 발생한다. 운영체제는 예외 상황이 발생했을 때, CPU의 제어권을 획득해 이 상황에 대한 조치를 취한다.
* ex) 0으로 나누는 연산, 자신의 주소 공간을 넘어서는 메모리 참조 등
* 예외 상황에 대한 처리 루틴을 자신의 코드 영역에 가지고 있다.

2. 시스템 콜(System Call)
* 사용자 프로세스가 운영체제의 서비스를 요청하기 위해 커널의 함수를 호출하는 것이다.
* 사용자 프로세스가 직접 특권 명령을 수행할 수 없으므로 특권 명령을 수행하려 할 때, 시스템 콜을 사용한다.

#### 소프트웨어 인터럽트 발생 과정
![소프트웨어 인터럽트 발생 과정](https://camo.githubusercontent.com/271627d5f3422254d27725f7a1bf3104c52475b1bfc73e143a100195fbf560d7/68747470733a2f2f6b2e6b616b616f63646e2e6e65742f646e2f516e714c682f62747176414243374561322f73666c50566972784e6457584f69516b633843517a312f696d672e706e67)

시스템 콜이나 예외 상황은 모두 사용자 프로세스로부터 CPU의 제어권이 운영 체제에게 이양되어 처리되는데 이 과정에 인터럽트 라인을 세팅하여 인터럽트를 발생시킨 후 제어권이 넘어가게 되므로 이들도 넓은 의미에서는 인터럽트의 범주에 포함시킨다. **단지 인터럽트를 발생시키는 주체가 하드웨어 장치가 아닌 소프트웨어이므로 이들을 소프트웨어 인터럽트라고 부른다.**

<br/>

## 인터럽트 발생 처리 과정

A 프로그램이 CPU를 할당받고 명령을 수행하고 있는데 인터럽트가 발생하면 A는 현재 수행중인 명령의 위치를 저장해놓는다. 그 후, 운영체제 내부 코드인 인터럽트 처리 루틴으로 넘어가서 인터럽트 처리를 하고 다시 돌아와 A의 이전 작업 지점부터 수행을 계속 이어나가게 된다.

**그렇다면, 인터럽트가 발생했을 때 수행중이던 프로세스의 정보는 어디에 저장?**

진행 중이던 A 프로세스의 정보는 프로세스 제어 블록(PCB: Process Control Block)에 저장한다. 그리고 인터럽트 처리를 모두 마치면 프로그램 A의 PCB에 저장된 주소를 복원시켜 원래 수행하던 일을 재개하게 된다.

* 인터럽트 벡터(Interrupt Vector)
  * 여러가지 인터럽트에 대한 해당 인터럽트 발생시 처리해야 할 루틴의 주소를 보관하고 있는 테이블
  * 일종의 함수를 가리키는 포인터

* 인터럽트 핸들러(Interrupt Handler)
  * 실제 인터럽트를 처리하기 위한 루틴으로 인터럽트 서비스 루틴이라고도 한다.
  * 운영체제 코드 부분에는 각종 인터럽트 별로 처리해야 할 내용이 이미 프로그램되어 있으며, 이 부분을 인터럽트 서비스 루틴 또는 인터럽트 핸들러라고 한다.

인터럽트는 인터럽트 된 명령어의 주소를 저장한 뒤, **인터럽트 벡터** 를 통해서 제어권을 인터럽트 핸들러로 넘겨준다. 인터럽트 벡터는 인터럽트를 처리할 수 있는 모든 서비스 루틴(Service Routine)의 주소를 저장하고 있는 공간으로, 파일 읽기/쓰기 등과 같은 중요한 동작들이 하드 코딩되어있다. 이렇게 인터럽트를 처리하고 나면 기존 작업으로 돌아온다.

<br/>

**[참조]**
* [원본링크1](https://github.com/WooVictory/Ready-For-Tech-Interview/blob/master/Operating%20System/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8(Interrupt).md)
* [원본링크2](https://gyoogle.dev/blog/computer-science/operating-system/Interrupt.html)